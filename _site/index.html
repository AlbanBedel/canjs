<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!--[if lt IE 7]> <html class="lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en"> <!--<![endif]-->
<head>
<title>CanJS</title>
<link rel="stylesheet" type="text/css" href="stylesheets/styles.css">
<link rel="stylesheet" type="text/css" href="stylesheets/tango.css">
</head>
<body>
<div id='bg'>
</div>
<div class='cf' id='wrapper'>
	<div id='menu-wrapper'>
		<div id='header'>
			<div id='logo-and-download'>
				<img alt="Logo" id="logo" src="images/logo.png"/>
				<a class='primary' href='#'>Download v3.3.3</a>
			</div>
		</div>
		<div class='cf' id='buttons'>
			<a href='#'>Visit Forums</a>
			<a href='#'>Fork on Github</a>
		</div>
		<ul id='menu'>
		</ul>
		<a href='#' id='developed-by'>
		<img alt="Bitovi" src="images/bitovi.png"/>
		</a>
	</div>
	<div id='content-wrapper'>
		<div id='content'>
			<a href="http://github.com/jupiterjs/canjs" class="github-fork"><img src="https://a248.e.akamai.net/assets.github.com/img/30f550e0d38ceb6ef5b81500c64d970b7fb0f028/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub"></a>
			<h1 id='welcome_to_canjs'>Welcome to CanJS!</h1>

<p>CanJS is an MIT-licensed, client-side, JavaScript framework that makes building rich web applications easy. It provides:</p>

<ul>
<li><strong>can.Construct</strong> - inheritable constructor functions</li>

<li><strong>can.Control</strong> - declaritive event bindings</li>

<li><strong>can.Model</strong> - connect data to a RESTful JSON interface</li>

<li><strong>can.Observe</strong> - key-value binding</li>

<li><strong>can.route</strong> - backbutton and bookmarking support</li>

<li><strong>can.view</strong> - dynamic live binding client side templates</li>
</ul>

<h2 id='get_canned'>Get Canned</h2>

<p>CanJS supports jQuery, Zepto, Dojo, YUI and Mootools. Select your download for the library you are using:</p>

<ul>
<li>can.jquery.js (8k)</li>

<li>can.zepto.js (9k)</li>

<li>can.dojo.js (9k)</li>

<li>can.mootools.js (9k)</li>

<li>can.yui.js (9k)</li>
</ul>

<p>This page walks through the basics of CanJS by building a small todo app with CanJS and jQuery. The <a href='#use_with_other_libraries'>Use with other libraries</a> section details the minor differencs between use with other libraries.</p>

<h2 id='canconstruct_'>can.Construct <code>can.Construct([classProps,] [prototypeProps])</code></h2>

<p>Constructor function made with <a href='http://donejs.com/docs.html#!can.Construct'>can.Construct</a> are used to create objects with shared properties. It&#8217;s used by both <strong>can.Control</strong> and <strong>can.Model</strong>.</p>

<p>To create a constructor function of your own, call <strong>can.Construct</strong> with the:</p>

<ul>
<li><strong>classProperties</strong> that are attached directly to the constructor, and</li>

<li>instance <strong>prototypeProperties</strong>.</li>
</ul>

<p><strong>can.Construct</strong> sets up the prototype chain so subclasses can be further extended and sub-classed as far as you like:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Todo</span> <span class='o'>=</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Construct</span><span class='p'>({</span>
  <span class='nx'>init</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(){},</span>
	
  <span class='nx'>author</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(){</span> <span class='p'>...</span> <span class='p'>},</span>
	
  <span class='nx'>coordinates</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(){</span> <span class='p'>...</span> <span class='p'>},</span>
	
  <span class='nx'>allowedToEdit</span><span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>account</span><span class='p'>)</span> <span class='p'>{</span> 
    <span class='k'>return</span> <span class='kc'>true</span><span class='p'>;</span>
  <span class='p'>}</span>
<span class='p'>});</span>
	
<span class='kd'>var</span> <span class='nx'>PrivateTodo</span> <span class='o'>=</span> <span class='nx'>Todo</span><span class='p'>({</span>
  <span class='nx'>allowedToEdit</span><span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>account</span><span class='p'>)</span> <span class='p'>{</span>
    <span class='k'>return</span> <span class='nx'>account</span><span class='p'>.</span><span class='nx'>owns</span><span class='p'>(</span><span class='k'>this</span><span class='p'>);</span>
  <span class='p'>}</span>
<span class='p'>});</span>
</code></pre>
</div>
<p>If only one set of properties is passed to <strong>can.Construct</strong>, it&#8217;s assumed to be the prototype properties.</p>

<h3 id='init_'>init <code>new can.Construct( [args ...] )</code></h3>

<p>When a constructor is called with the <code>new</code> keyword, <strong>can.Construct</strong> creates the instance and calls <a href='donejs.com/docs.html#!can.Construct.prototype.init'>can.Construct.prototype.init</a> with the arguments passed to <code>new Constructor(...)</code>.</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Todo</span> <span class='o'>=</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Construct</span><span class='p'>({</span>
  <span class='nx'>init</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>text</span><span class='p'>)</span> <span class='p'>{</span>
    <span class='k'>this</span><span class='p'>.</span><span class='nx'>text</span> <span class='o'>=</span> <span class='nx'>text</span>
  <span class='p'>},</span>
  <span class='nx'>read</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(){</span>
    <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='k'>this</span><span class='p'>.</span><span class='nx'>text</span><span class='p'>);</span>
  <span class='p'>}</span>
<span class='p'>})</span>
	
<span class='kd'>var</span> <span class='nx'>todo</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Todo</span><span class='p'>(</span><span class='s2'>&quot;Hello World&quot;</span><span class='p'>);</span>
<span class='nx'>todo</span><span class='p'>.</span><span class='nx'>read</span><span class='p'>()</span>
</code></pre>
</div>
<h2 id='canobserve_'>can.Observe <code>new can.Observe( data )</code></h2>

<p><a href='http://donejs.com/docs.html#!can.Observe'>can.Observe</a> provides the observable pattern for JavaScript Objects. It lets you:</p>

<ul>
<li>Set and remove property values on objects.</li>

<li>Listen for property changes changes.</li>

<li>Work with nested properties.</li>
</ul>

<p>To create an observable object, use <code>new can.Observe( [data] )</code> like:</p>
<div class='highlight'><pre><code class='javascript'>	<span class='kd'>var</span> <span class='nx'>paginate</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Observe</span><span class='p'>({</span><span class='nx'>offset</span><span class='o'>:</span> <span class='mi'>0</span><span class='p'>,</span> <span class='nx'>limit</span> <span class='o'>:</span> <span class='mi'>100</span><span class='p'>,</span> <span class='nx'>count</span><span class='o'>:</span> <span class='mi'>2000</span><span class='p'>})</span>
</code></pre>
</div>
<p>To create an observable array, use <code>new can.Observe.List( [array] )</code> like:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>hobbies</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Observe</span><span class='p'>.</span><span class='nx'>List</span><span class='p'>([</span><span class='s1'>&#39;programming&#39;</span><span class='p'>,</span> 
                             <span class='s1'>&#39;basketball&#39;</span><span class='p'>,</span> 
                             <span class='s1'>&#39;party rocking&#39;</span><span class='p'>])</span>
</code></pre>
</div>
<p><strong>can.Observe</strong> is used by both <strong>can.Model</strong> and <strong>can.route</strong>. However, observe is useful on its own to maintain client-side state (such as pagination data).</p>

<h3 id='attr_'>attr <code>observe.attr( [name,] [value] )</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Observe.prototype.attr'>can.Observe.prototype.attr</a> reads or sets properties on an observe:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>paginate</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>(</span><span class='s1'>&#39;offset&#39;</span><span class='p'>)</span> <span class='c1'>//-&gt; 0</span>
	
<span class='nx'>paginate</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>(</span><span class='s1'>&#39;offset&#39;</span><span class='p'>,</span> <span class='mi'>100</span> <span class='p'>);</span>
	
<span class='nx'>paginate</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>()</span> <span class='c1'>//-&gt; {offset: 100, limit : 100, count: 2000}</span>
	
<span class='nx'>paginate</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>({</span><span class='nx'>limit</span><span class='o'>:</span> <span class='mi'>200</span><span class='p'>,</span> <span class='nx'>count</span><span class='o'>:</span> <span class='mi'>1000</span><span class='p'>});</span>
</code></pre>
</div>
<h3 id='removeattr_'>removeAttr <code>observe.removeAttr( name )</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Observe.prototype.removeAttr'>can.Observe.prototype.removeAttr</a> removes a property by name from an observe. This is similar to using the <code>delete</code> keyword to remove a property.</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>o</span> <span class='o'>=</span>  <span class='k'>new</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Observe</span><span class='p'>({</span><span class='nx'>foo</span><span class='o'>:</span> <span class='s1'>&#39;bar&#39;</span><span class='p'>});</span>
<span class='nx'>o</span><span class='p'>.</span><span class='nx'>removeAttr</span><span class='p'>(</span><span class='s1'>&#39;foo&#39;</span><span class='p'>);</span> <span class='c1'>//-&gt; &#39;bar&#39;</span>
</code></pre>
</div>
<h3 id='bind_'>bind <code>observe.bind( eventType, handler(args...) )</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Observe.prototype.bind'>can.Observe.prototype.bind</a> listens to changes on a <strong>can.Observe</strong>. There are two types of events triggered as a result of an attribute change:</p>

<ul>
<li><code>change</code> events - a generic event so you can listen to any property change and how it was changed</li>

<li><code>ATTR_NAME</code> events - bind to specific attribute changes</li>
</ul>

<p>The following listens to a all attribute changes and &#8216;offset&#8217; changes on the paginate instance:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>paginate</span><span class='p'>.</span><span class='nx'>bind</span><span class='p'>(</span><span class='s1'>&#39;change&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>ev</span><span class='p'>,</span> <span class='nx'>attr</span><span class='p'>,</span> <span class='nx'>how</span><span class='p'>,</span> <span class='nx'>newVal</span><span class='p'>,</span> <span class='nx'>oldVal</span><span class='p'>){</span>
   <span class='c1'>// attr = &#39;offset&#39;</span>
   <span class='c1'>// how = &#39;set&#39;</span>
   <span class='c1'>// newVal = 200</span>
   <span class='c1'>// oldVal = 100</span>
<span class='p'>}).</span><span class='nx'>bind</span><span class='p'>(</span><span class='s1'>&#39;offset&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>ev</span><span class='p'>,</span> <span class='nx'>newVal</span><span class='p'>,</span> <span class='nx'>oldVal</span><span class='p'>){</span>
   <span class='c1'>// newVal = 200</span>
   <span class='c1'>// oldVal = 100</span>
<span class='p'>})</span>
<span class='nx'>paginate</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>(</span><span class='s1'>&#39;offset&#39;</span><span class='p'>,</span> <span class='mi'>200</span><span class='p'>);</span>
</code></pre>
</div>
<h3 id='unbind_'>unbind <code>observe.unbind( eventType, handler )</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Observe.prototype.unbind'>can.Observe.prototype.unbind</a> stops listening to an event. The same function that was used for the handler in <code>bind</code> must be passed to <code>unbind</code>.</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>countHandler</span> <span class='o'>=</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>ev</span><span class='p'>,</span> <span class='nx'>newVal</span><span class='p'>,</span> <span class='nx'>oldVal</span><span class='p'>){</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='s2'>&quot;the count has changed&quot;</span><span class='p'>);</span>
<span class='p'>}</span>
<span class='nx'>paginate</span><span class='p'>.</span><span class='nx'>bind</span><span class='p'>(</span><span class='s1'>&#39;count&#39;</span><span class='p'>,</span><span class='nx'>countHandler</span><span class='p'>);</span>
<span class='nx'>paginate</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>(</span><span class='s1'>&#39;count&#39;</span><span class='p'>,</span> <span class='mi'>3000</span><span class='p'>);</span>
<span class='nx'>paginate</span><span class='p'>.</span><span class='nx'>unbind</span><span class='p'>(</span><span class='s1'>&#39;count&#39;</span><span class='p'>,</span> <span class='nx'>countHandler</span><span class='p'>);</span>
</code></pre>
</div>
<h3 id='each_'>each <code>observe.each( handler(attrName, value) )</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Observe.prototype.each'>can.Observe.prototype.each</a> iterates through each attribute, calling handler with each attribute name and value.</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>paginate</span><span class='p'>.</span><span class='nx'>each</span><span class='p'>(</span><span class='kd'>function</span><span class='p'>(</span><span class='nx'>name</span><span class='p'>,</span> <span class='nx'>value</span><span class='p'>){</span>
   <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span> <span class='nx'>name</span><span class='p'>,</span> <span class='nx'>value</span><span class='p'>);</span>
<span class='p'>})</span>
<span class='c1'>// writes:</span>
<span class='c1'>//  offset 200</span>
<span class='c1'>//  limit 200</span>
<span class='c1'>//  count 1000}</span>
</code></pre>
</div>
<h3 id='canobservelist_'>can.Observe.List <code>new can.Observe.List( [array] )</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Observe.List'>can.Observe.List</a> inherits from <strong>can.Observe</strong> but adds list specific methods such as:</p>

<ul>
<li><a href='http://donejs.com/docs.html#!can.Observe.List.prototype.indexOf'>indexOf</a> <code>list.indexOf( item )</code> - Returns the position of the item in the list.</li>

<li><a href='http://donejs.com/docs.html#!can.Observe.List.prototype.pop'>pop</a> <code>list.pop()</code> - removes the last item in the list.</li>

<li><a href='http://donejs.com/docs.html#!can.Observe.List.prototype.push'>push</a> <code>list.push(items...)</code> - adds items to the end of the list.</li>

<li><a href='http://donejs.com/docs.html#!can.Observe.List.prototype.shift'>shift</a> <code>list.shift()</code> - removes the first item in the list.</li>

<li><a href='http://donejs.com/docs.html#!can.Observe.List.prototype.splice'>splice</a> <code>list.splice(index, howMany, [items...])</code> - removes and inserts items at the specified index.</li>

<li><a href='http://donejs.com/docs.html#!can.Observe.List.prototype.unshift'>unshift</a> <code>list.unshift(items...)</code> - adds items to the start of the list.</li>
</ul>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>hobbies</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Observe</span><span class='p'>.</span><span class='nx'>List</span><span class='p'>([</span><span class='s1'>&#39;programming&#39;</span><span class='p'>,</span> 
                               <span class='s1'>&#39;basketball&#39;</span><span class='p'>,</span> 
                               <span class='s1'>&#39;party rocking&#39;</span><span class='p'>])</span>
                               
<span class='c1'>// listen to changes in the list</span>
<span class='nx'>hobbies</span><span class='p'>.</span><span class='nx'>bind</span><span class='p'>(</span><span class='s2'>&quot;add&quot;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>ev</span><span class='p'>,</span> <span class='nx'>newVals</span><span class='p'>,</span> <span class='nx'>index</span><span class='p'>){</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='s2'>&quot;added&quot;</span><span class='p'>,</span><span class='nx'>newVals</span><span class='p'>,</span><span class='s2'>&quot;at&quot;</span><span class='p'>,</span><span class='nx'>index</span><span class='p'>);</span>
<span class='p'>}).</span><span class='nx'>bind</span><span class='p'>(</span><span class='s2'>&quot;remove&quot;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>ev</span><span class='p'>,</span> <span class='nx'>oldVals</span><span class='p'>,</span> <span class='nx'>index</span><span class='p'>){</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='s2'>&quot;removed&quot;</span><span class='p'>,</span><span class='nx'>oldVals</span><span class='p'>,</span><span class='s2'>&quot;at&quot;</span><span class='p'>,</span><span class='nx'>index</span><span class='p'>);</span>
<span class='p'>})</span>

<span class='c1'>// modify the list</span>
<span class='nx'>hobbies</span><span class='p'>.</span><span class='nx'>pop</span><span class='p'>()</span>
<span class='nx'>hobbies</span><span class='p'>.</span><span class='nx'>unshift</span><span class='p'>(</span><span class='s2'>&quot;rocking parties&quot;</span><span class='p'>)</span>
</code></pre>
</div>
<h2 id='canmodel_'>can.Model <code>can.Model([classProperties,] [prototypeProperties])</code></h2>

<p><a href='http://donejs.com/docs.html#!can.Model'>can.Model</a> is a <a href='#can_observe'>can.Observe</a> that connects to a RESTful interface.</p>

<p>Extend <a href='http://donejs.com/docs.html#!can.Model'>can.Model</a> with your domain specific methods and can.Model provides a set of methods for managing changes.</p>

<p>To create a <strong>Model</strong> class, call <strong>can.Model</strong> with:</p>

<ul>
<li><strong>classProperties</strong>, including <a href='http://donejs.com/docs.html#!can.Model.findAll'>findAll</a>, <a href='http://donejs.com/docs.html#!can.Model.findAll'>findOne</a>, <a href='http://donejs.com/docs.html#!can.Model.create'>create</a>, <a href='http://donejs.com/docs.html#!can.Model.update'>update</a>, <a href='http://donejs.com/docs.html#!can.Model.destroy'>destroy</a> properties, and</li>

<li>any <strong>prototypeProperties</strong> helper methods.</li>
</ul>

<p>Make a Todo model in <strong>todos.js</strong> like the following:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Todo</span> <span class='o'>=</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Model</span><span class='p'>({</span>
  <span class='nx'>findAll</span> <span class='o'>:</span> <span class='s2'>&quot;GET /todos&quot;</span><span class='p'>,</span>
  <span class='nx'>findOne</span> <span class='o'>:</span> <span class='s2'>&quot;GET /todos/{id}&quot;</span><span class='p'>,</span>
  <span class='nx'>create</span>  <span class='o'>:</span> <span class='s2'>&quot;POST /todos&quot;</span><span class='p'>,</span>
  <span class='nx'>update</span>  <span class='o'>:</span> <span class='s2'>&quot;PUT /todos/{id}&quot;</span><span class='p'>,</span>
  <span class='nx'>destroy</span> <span class='o'>:</span> <span class='s2'>&quot;DELETE /todos/{id}&quot;</span>
<span class='p'>},</span>
<span class='p'>{})</span>
</code></pre>
</div>
<h3 id='init_'>init <code>new can.Model(attributes)</code></h3>

<p>Create a todo instance like:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>todo</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Todo</span><span class='p'>({</span><span class='nx'>name</span><span class='o'>:</span> <span class='s2'>&quot;do the dishes&quot;</span><span class='p'>});</span>
</code></pre>
</div>
<h3 id='attr_'>attr <code>model.attr( name, [value] )</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Model.prototype.attr'>can.Model.prototype.attr</a> reads or sets properties on model instances. It works the same way as <a href='#can_observe-attr'>can.Observe.prototype.attr</a>.</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>todo</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>(</span><span class='s1'>&#39;name&#39;</span><span class='p'>)</span> <span class='c1'>//-&gt; &quot;do the dishes&quot;</span>

<span class='nx'>todo</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>(</span><span class='s1'>&#39;name&#39;</span><span class='p'>,</span> <span class='s2'>&quot;wash the dishes&quot;</span> <span class='p'>);</span>

<span class='nx'>todo</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>()</span> <span class='c1'>//-&gt; {name: &quot;wash the dishes&quot;}</span>

<span class='nx'>todo</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>({</span><span class='nx'>name</span><span class='o'>:</span> <span class='s2'>&quot;did the dishes&quot;</span><span class='p'>});</span>
</code></pre>
</div>
<h3 id='talking_to_the_server'>Talking to the server</h3>

<p>Model uses static <a href='http://donejs.com/docs.html#!can.Model.findAll'>findAll</a>, <a href='http://donejs.com/docs.html#!can.findAll'>findOne</a>, <a href='http://donejs.com/docs.html#!can.create'>create</a>, <a href='http://donejs.com/docs.html#!can.update'>update</a>, and <a href='http://donejs.com/docs.html#!can.destroy'>destroy</a> methods to create, read, update and delete (CRUD) model data on the server.</p>

<p>By filling these functions out, you are able to call <strong>findAll</strong> and <strong>findOne</strong> on the model to retrieve model instances and <strong>save</strong> and <strong>destroy</strong> on instances.</p>

<h3 id='findall_'>findAll <code>findAll( params, success( models ), error() ) -&gt; Deferred</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Model.findAll'>can.Model.findAll</a> retrieves multiple instances from the server:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findAll</span><span class='p'>({},</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>todos</span> <span class='p'>)</span> <span class='p'>{</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span> <span class='nx'>todos</span><span class='p'>[</span><span class='mi'>0</span><span class='p'>].</span><span class='nx'>name</span> <span class='p'>);</span>
<span class='p'>})</span> <span class='c1'>//-&gt; Deferred</span>
</code></pre>
</div>
<p>This makes a request to <code>GET /todos</code> which should return JSON like:</p>
<div class='highlight'><pre><code class='javascript'><span class='p'>[{</span>
  <span class='s2'>&quot;id&quot;</span> <span class='o'>:</span> <span class='mi'>1</span><span class='p'>,</span>
  <span class='s2'>&quot;name&quot;</span> <span class='o'>:</span> <span class='s2'>&quot;do the dishes&quot;</span>
<span class='p'>},{</span>
  <span class='s2'>&quot;id&quot;</span> <span class='o'>:</span> <span class='mi'>2</span><span class='p'>,</span>
  <span class='s2'>&quot;name&quot;</span> <span class='o'>:</span> <span class='s2'>&quot;mow the lawn&quot;</span>
<span class='p'>},{</span>
  <span class='s2'>&quot;id&quot;</span> <span class='o'>:</span> <span class='mi'>3</span><span class='p'>,</span>
  <span class='s2'>&quot;name&quot;</span> <span class='o'>:</span> <span class='s2'>&quot;iron my shirts&quot;</span>
<span class='p'>}]</span>
</code></pre>
</div>
<p>The <strong>todos</strong> parameter is a <a href='#can_model-can_model_list'>can.Model.List</a> of todo instances. <code>Todo.findAll</code> returns a <a href='#utilities-deferred'>deferred</a> that resolves to the <strong>todos</strong> list.</p>

<h3 id='findone_'>findOne <code>findOne( params, success( model ), error() ) -&gt; Deferred</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Model.findOne'>findOne</a> retrieves a single model instance:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findOne</span><span class='p'>({</span><span class='nx'>id</span><span class='o'>:</span> <span class='mi'>1</span><span class='p'>},</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>todo</span> <span class='p'>)</span> <span class='p'>{</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span> <span class='nx'>todo</span><span class='p'>.</span><span class='nx'>name</span> <span class='p'>);</span>
<span class='p'>})</span>
</code></pre>
</div>
<p>This makes a request to <code>GET /todos/{id}</code> which should return JSON like:</p>
<div class='highlight'><pre><code class='javascript'><span class='p'>{</span>
  <span class='s2'>&quot;id&quot;</span> <span class='o'>:</span> <span class='mi'>1</span><span class='p'>,</span>
  <span class='s2'>&quot;name&quot;</span> <span class='o'>:</span> <span class='s2'>&quot;do the dishes&quot;</span>
<span class='p'>}</span>
</code></pre>
</div>
<p>The <strong>todo</strong> parameter is model instance. <code>Todo.findOne</code> returns a <a href='#utilities-deferred'>deferred</a> that resolves to the <strong>todo</strong> instance.</p>

<h3 id='save_'>save <code>todo.save( success( todo ), error() ) -&gt; Deferred</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Model.prototype.save'>can.Model.prototype.save</a> <strong>creates</strong> or <strong>updates</strong> instances depending if the instance has already been created or not.</p>

<p>To <strong>create</strong> a todo on the server, create a todo instance and call <strong>save</strong> like the following:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>todo</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Todo</span><span class='p'>({</span><span class='nx'>name</span><span class='o'>:</span> <span class='s2'>&quot;mow lawn&quot;</span><span class='p'>})</span>
<span class='nx'>todo</span><span class='p'>.</span><span class='nx'>save</span><span class='p'>(</span><span class='kd'>function</span><span class='p'>(</span><span class='nx'>todo</span><span class='p'>){</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span> <span class='nx'>todo</span> <span class='p'>);</span>
<span class='p'>})</span>
</code></pre>
</div>
<p>This makes a request to <code>POST /todos</code> with <code>name=mow lawn</code> and should get a response with the <strong>id</strong> like:</p>
<div class='highlight'><pre><code class='javascript'><span class='p'>{</span> <span class='s2'>&quot;id&quot;</span> <span class='o'>:</span> <span class='mi'>5</span> <span class='p'>}</span>
</code></pre>
</div>
<p><strong>save</strong> calls back with the original todo instance and returns a deferred that resolves with the todo after it has been created on the server.</p>

<p>To <strong>update</strong> a todo on the server, change the attributes and call <strong>save</strong> again like the following:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>todo</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Todo</span><span class='p'>({</span><span class='nx'>name</span><span class='o'>:</span> <span class='s2'>&quot;mow lawn&quot;</span><span class='p'>});</span>
<span class='nx'>todo</span><span class='p'>.</span><span class='nx'>save</span><span class='p'>(</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>todo</span><span class='p'>){</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='s2'>&quot;created&quot;</span><span class='p'>,</span> <span class='nx'>todo</span> <span class='p'>);</span>
  
  <span class='nx'>todo</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>(</span><span class='s2'>&quot;name&quot;</span><span class='p'>,</span> <span class='s2'>&quot;mow my lawn&quot;</span><span class='p'>)</span>
  <span class='nx'>todo</span><span class='p'>.</span><span class='nx'>save</span><span class='p'>(</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>todo</span> <span class='p'>)</span> <span class='p'>{</span>
    <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='s2'>&quot;updated&quot;</span><span class='p'>,</span> <span class='nx'>todo</span> <span class='p'>);</span>
  <span class='p'>})</span>
<span class='p'>})</span>
</code></pre>
</div>
<p>This makes a request to <code>POST /todos/5</code> with <code>name=mow my lawn</code> and only needs to get a successful response.</p>

<h3 id='destroy_'>destroy <code>todo.destroy( success( todo ), error() ) -&gt; Deferred</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Model.prototype.destroy'>can.Model.prototype.destroy</a> deletes a record on the server. You can do this like:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>todo</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Todo</span><span class='p'>({</span><span class='nx'>name</span><span class='o'>:</span> <span class='s2'>&quot;mow lawn&quot;</span><span class='p'>});</span>
<span class='nx'>todo</span><span class='p'>.</span><span class='nx'>save</span><span class='p'>(</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>todo</span><span class='p'>){</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='s2'>&quot;created&quot;</span><span class='p'>,</span> <span class='nx'>todo</span> <span class='p'>);</span>
  
  <span class='nx'>todo</span><span class='p'>.</span><span class='nx'>destroy</span><span class='p'>(</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>todo</span> <span class='p'>)</span> <span class='p'>{</span>
    <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='s2'>&quot;destroyed&quot;</span><span class='p'>,</span> <span class='nx'>todo</span> <span class='p'>);</span>
  <span class='p'>})</span>
<span class='p'>})</span>
</code></pre>
</div>
<p>This makes a request to <code>DELETE /todos/5</code> and only needs a successful response. Like <strong>save</strong>, the callback&#8217;s <code>todo</code> parameter is the destroyed instance and a deferred is returned that resolves with the <code>todo</code> after it has been destroyed by the server.</p>

<h3 id='bind_'>bind <code>model.bind( event, handler(ev, model ) ) -&gt; model</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Model.prototype.bind'>can.Model.prototype.bind</a> listens to changes in a model instance&#8217;s attributes in the same way as <span>Observe&#8217;s bind(#an_observe-bind). For example:</span></p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>todo</span><span class='p'>.</span><span class='nx'>bind</span><span class='p'>(</span><span class='s2'>&quot;name&quot;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>ev</span><span class='p'>,</span> <span class='nx'>newVal</span><span class='p'>,</span> <span class='nx'>oldVal</span> <span class='p'>){</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='s2'>&quot;name changed to&quot;</span><span class='p'>,</span> <span class='nx'>newVal</span><span class='p'>);</span>
<span class='p'>})</span>
</code></pre>
</div>
<p>In addition to Observe&#8217;s events, Model also supports three new events:</p>

<ul>
<li><strong>created</strong> - an instance is created on the server</li>

<li><strong>updated</strong> - an instance is updated on the server</li>

<li><strong>destroyed</strong> - an instance is destroyed on the server</li>
</ul>

<p>For example, listen to when an instance is <strong>created</strong> on the server like:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>todo</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Todo</span><span class='p'>({</span><span class='nx'>name</span><span class='o'>:</span> <span class='s2'>&quot;mow lawn&quot;</span><span class='p'>});</span>
<span class='nx'>todo</span><span class='p'>.</span><span class='nx'>bind</span><span class='p'>(</span><span class='s1'>&#39;created&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>ev</span><span class='p'>,</span> <span class='nx'>todo</span><span class='p'>){</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='s2'>&quot;created&quot;</span><span class='p'>,</span> <span class='nx'>todo</span> <span class='p'>);</span>
<span class='p'>})</span>
<span class='nx'>todo</span><span class='p'>.</span><span class='nx'>save</span><span class='p'>()</span>
</code></pre>
</div>
<p><a href='http://donejs.com/docs.html#!can.Model.static.bind'>can.Model.bind</a> lets you listen to anytime <strong>any</strong> instance is <strong>created</strong>, <strong>updated</strong>, or <strong>destroyed</strong>:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>bind</span><span class='p'>(</span><span class='s1'>&#39;created&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>ev</span><span class='p'>,</span> <span class='nx'>todo</span><span class='p'>){</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='s2'>&quot;created&quot;</span><span class='p'>,</span> <span class='nx'>todo</span> <span class='p'>);</span>
<span class='p'>})</span>
</code></pre>
</div>
<h3 id='canmodellist_'>can.Model.List <code>new can.Model.List( items )</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Model.List'>can.Model.List</a> is a <a href='#can_observe-can_observe_list'>can.Observe.List</a> that automatically removes items when they are destroyed. <strong>Model.Lists</strong> are return by <a href='#can_model-findAll'>findAll</a>.</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findAll</span><span class='p'>({},</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>todos</span><span class='p'>){</span>

  <span class='c1'>// listen when a todo is removed</span>
  <span class='nx'>todos</span><span class='p'>.</span><span class='nx'>bind</span><span class='p'>(</span><span class='s2'>&quot;remove&quot;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>ev</span><span class='p'>,</span> <span class='nx'>removed</span><span class='p'>,</span> <span class='nx'>index</span><span class='p'>){</span>
    <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='s2'>&quot;removed&quot;</span><span class='p'>,</span> <span class='nx'>removed</span><span class='p'>.</span><span class='nx'>length</span><span class='p'>,</span> <span class='s2'>&quot;todos&quot;</span><span class='p'>);</span>
  <span class='p'>})</span>
  
  <span class='c1'>// destroy the first todo</span>
  <span class='nx'>todos</span><span class='p'>[</span><span class='mi'>0</span><span class='p'>].</span><span class='nx'>destroy</span><span class='p'>()</span>
<span class='p'>})</span>
</code></pre>
</div>
<h2 id='canview_'>can.view <code>can.view( idOrUrl, data ) -&gt; documentFragment</code></h2>

<p><a href='http://donejs.com/docs.html#!can.view'>can.view</a> is used to load, render, and create HTMLElements from JavaScript templates. Pass it &#8230;</p>

<ul>
<li>the <strong>id</strong> or <strong>url</strong> of a script tag to use as the content of the template</li>

<li><strong>data</strong> to pass to the template</li>
</ul>

<p>It returns the rendered result of the template as a documentFragment.</p>
<div class='highlight'><pre><code class='javascript'><span class='nb'>document</span><span class='p'>.</span><span class='nx'>getElementById</span><span class='p'>(</span><span class='s1'>&#39;todos&#39;</span><span class='p'>)</span>
  <span class='p'>.</span><span class='nx'>appendChild</span><span class='p'>(</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>view</span><span class='p'>(</span><span class='s1'>&#39;todos.ejs&#39;</span><span class='p'>,</span> <span class='p'>[{</span><span class='nx'>name</span><span class='o'>:</span> <span class='s2'>&quot;mow lawn&quot;</span><span class='p'>}]</span> <span class='p'>)</span> <span class='p'>)</span>
</code></pre>
</div>
<p><code>can.view</code> supports multiple templating languages; however, <a href='#can_ejs'>can.EJS</a> is packaged with CanJS and supports live-binding of <a href='#can_observe'>can.Observe</a>.</p>

<h3 id='loading_templates'>Loading Templates</h3>

<p><code>can.view</code> loads templates from a url or a script tag. To load from a <strong>script</strong> tag, create a script tag with the template contents, an id, and a type attribute that specifies the template type (text/ejs).</p>

<p>For example, add the following <strong>html</strong>:</p>
<div class='highlight'><pre><code class='erb'><span class='x'>&lt;script type=&#39;text/ejs&#39; id=&#39;todosEJS&#39;&gt;</span>
<span class='x'>  </span><span class='cp'>&lt;%</span> <span class='k'>for</span><span class='p'>(</span><span class='n'>var</span> <span class='n'>i</span> <span class='o'>=</span> <span class='mi'>0</span><span class='p'>;</span> <span class='n'>i</span> <span class='o'>&lt;</span> <span class='n'>this</span><span class='o'>.</span><span class='n'>length</span><span class='p'>;</span> <span class='n'>i</span><span class='o'>++</span> <span class='p'>){</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>    &lt;li&gt;</span><span class='cp'>&lt;%=</span> <span class='n'>this</span><span class='o'>[</span><span class='n'>i</span><span class='o'>].</span><span class='n'>name</span> <span class='cp'>%&gt;</span><span class='x'>&lt;/li&gt;</span>
<span class='x'>  </span><span class='cp'>&lt;%</span> <span class='p'>}</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>&lt;/script&gt;</span>
</code></pre>
</div>
<p>Render this template and insert it into the page:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findAll</span><span class='p'>(</span> <span class='p'>{},</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>todos</span> <span class='p'>){</span>
   <span class='nb'>document</span><span class='p'>.</span><span class='nx'>getElementById</span><span class='p'>(</span><span class='s1'>&#39;todos&#39;</span><span class='p'>)</span>
           <span class='p'>.</span><span class='nx'>appendChild</span><span class='p'>(</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>view</span><span class='p'>(</span> <span class='s1'>&#39;todosEJS&#39;</span><span class='p'>,</span> <span class='nx'>todos</span> <span class='p'>)</span> <span class='p'>);</span>
<span class='p'>});</span>
</code></pre>
</div>
<p>To load from a <strong>url</strong>, create a <em>todos/todos.ejs</em> file that contains:</p>
<div class='highlight'><pre><code class='erb'><span class='cp'>&lt;%</span> <span class='k'>for</span><span class='p'>(</span><span class='n'>var</span> <span class='n'>i</span> <span class='o'>=</span> <span class='mi'>0</span><span class='p'>;</span> <span class='n'>i</span> <span class='o'>&lt;</span> <span class='n'>this</span><span class='o'>.</span><span class='n'>length</span><span class='p'>;</span> <span class='n'>i</span><span class='o'>++</span> <span class='p'>){</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>  &lt;li&gt;</span><span class='cp'>&lt;%=</span> <span class='n'>this</span><span class='o'>[</span><span class='n'>i</span><span class='o'>].</span><span class='n'>name</span> <span class='cp'>%&gt;</span><span class='x'>&lt;/li&gt;</span>
<span class='cp'>&lt;%</span> <span class='p'>}</span> <span class='cp'>%&gt;</span><span class='x' />
</code></pre>
</div>
<p>Render this with:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findAll</span><span class='p'>(</span> <span class='p'>{},</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>todos</span> <span class='p'>){</span>
  <span class='nb'>document</span><span class='p'>.</span><span class='nx'>getElementById</span><span class='p'>(</span><span class='s1'>&#39;todos&#39;</span><span class='p'>)</span>
           <span class='p'>.</span><span class='nx'>appendChild</span><span class='p'>(</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>view</span><span class='p'>(</span> <span class='s1'>&#39;todos/todos.ejs&#39;</span><span class='p'>,</span> <span class='nx'>todos</span> <span class='p'>)</span> <span class='p'>);</span>
<span class='p'>});</span>
</code></pre>
</div>
<h3 id='deferreds'>Deferreds</h3>

<p><strong>can.view</strong> accepts <a href='#utilities-deferred'>deferreds</a>. If the <code>data</code> argument is a deferred or an object that contains deferreds, <strong>can.view</strong> returns a deferred that resolves to the documentFragment after all deferreds have resolved and the template has loaded.</p>

<p><a href='#can_model-findAll'>can.Model.findAll</a> returns deferreds. This means that the following loads <code>todos/todos.ejs</code>, <code>Todo.findAll</code> and <code>User.findOne</code> in parallel and resolves the returned deferred with the documentFragment when they are all done:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>can</span><span class='p'>.</span><span class='nx'>view</span><span class='p'>(</span><span class='s1'>&#39;todos/todos.ejs&#39;</span><span class='p'>,</span> <span class='p'>{</span>
  <span class='nx'>todos</span> <span class='o'>:</span> <span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findAll</span><span class='p'>(),</span>
  <span class='nx'>user</span><span class='o'>:</span> <span class='nx'>User</span><span class='p'>.</span><span class='nx'>findOne</span><span class='p'>({</span> <span class='nx'>id</span><span class='o'>:</span> <span class='mi'>5</span> <span class='p'>})</span>
<span class='p'>}).</span><span class='nx'>then</span><span class='p'>(</span><span class='kd'>function</span><span class='p'>(</span> <span class='nx'>frag</span> <span class='p'>){</span>
  <span class='nb'>document</span><span class='p'>.</span><span class='nx'>getElementById</span><span class='p'>(</span><span class='s1'>&#39;todos&#39;</span><span class='p'>)</span>
          <span class='p'>.</span><span class='nx'>appendChild</span><span class='p'>(</span><span class='nx'>frag</span><span class='p'>);</span>
<span class='p'>})</span>
</code></pre>
</div>
<h3 id='render_'>render <code>can.view.render( idOrUrl, data )</code></h3>

<p>To render a string instead of a documentFragment, use <a href=''>can.view.render</a> like:</p>
<div class='highlight'><pre><code class='javascript'><span class='o'>&lt;%</span> <span class='k'>for</span><span class='p'>(</span> <span class='kd'>var</span> <span class='nx'>i</span> <span class='o'>=</span> <span class='mi'>0</span><span class='p'>;</span> <span class='nx'>i</span> <span class='o'>&lt;</span> <span class='nx'>todos</span><span class='p'>.</span><span class='nx'>length</span><span class='p'>;</span> <span class='nx'>i</span><span class='o'>++</span><span class='p'>)</span> <span class='o'>%&gt;</span>
  <span class='o'>&lt;</span><span class='nx'>li</span><span class='o'>&gt;&lt;%==</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>view</span><span class='p'>.</span><span class='nx'>render</span><span class='p'>(</span><span class='s2'>&quot;/todos/todo.ejs&quot;</span><span class='p'>,{</span>
             <span class='nx'>todo</span><span class='o'>:</span> <span class='nx'>todo</span><span class='p'>[</span><span class='nx'>i</span><span class='p'>]</span>
            <span class='p'>})</span> <span class='o'>%&gt;</span>
  <span class='o'>&lt;</span><span class='err'>/li&gt;</span>
<span class='o'>&lt;%</span> <span class='p'>})</span> <span class='o'>%&gt;</span>
</code></pre>
</div>
<p><strong>can.view.render&#8211;</strong></p>

<h2 id='canejs_'>can.EJS <code>new can.EJS( options )</code></h2>

<p><a href='http://donejs.com/docs.html#!can.EJS'>can.EJS</a> is CanJS&#8217;s default template language and used with <a href='#!can_view'>can.view</a>. It provides live binding when use dwith <a href='#can_observe'>can.Observes</a>. A <strong>can.EJS</strong> template looks like the HTML you want, but with <strong>magic tags</strong> where you want dynamic behavior. The following lists todo elements:</p>
<div class='highlight'><pre><code class='erb'><span class='x'>&lt;script type=&#39;text/ejs&#39; id=&#39;todosEJS&#39;&gt;</span>
<span class='cp'>&lt;%</span> <span class='k'>for</span><span class='p'>(</span> <span class='n'>var</span> <span class='n'>i</span> <span class='o'>=</span> <span class='mi'>0</span><span class='p'>;</span> <span class='n'>i</span> <span class='o'>&lt;</span> <span class='n'>this</span><span class='o'>.</span><span class='n'>length</span><span class='p'>;</span> <span class='n'>i</span><span class='o'>++</span><span class='p'>)</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>  &lt;li&gt;</span><span class='cp'>&lt;%=</span> <span class='n'>this</span><span class='o'>[</span><span class='n'>i</span><span class='o'>].</span><span class='n'>name</span> <span class='cp'>%&gt;</span><span class='x'>&lt;/li&gt;</span>
<span class='cp'>&lt;%</span> <span class='p'>})</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>&lt;/script&gt;</span>
</code></pre>
</div>
<p>Use <strong>can.view</strong> to render this template:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findAll</span><span class='p'>({},</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>todos</span> <span class='p'>)</span> <span class='p'>{</span>
  <span class='nb'>document</span><span class='p'>.</span><span class='nx'>getElementById</span><span class='p'>(</span><span class='s1'>&#39;todos&#39;</span><span class='p'>)</span>
          <span class='p'>.</span><span class='nx'>appendChild</span><span class='p'>(</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>view</span><span class='p'>(</span><span class='s1'>&#39;todosEJS&#39;</span><span class='p'>,</span> <span class='nx'>todos</span> <span class='p'>)</span> <span class='p'>)</span>
<span class='p'>}</span>
</code></pre>
</div>
<p>Notice that <code>this</code> in the template is the list of todos. The <code>data</code> argument passed <strong>can.view</strong> becomes <code>this</code> in EJS. EJS can also access any properties of <code>this</code> directly (without writing <code>this.PROPERTY</code> all the time). For example, a template that lists the user&#8217;s name and todos:</p>
<div class='highlight'><pre><code class='erb'><span class='x'>&lt;script type=&#39;text/ejs&#39; id=&#39;todosEJS&#39;&gt;</span>
<span class='x'>&lt;h2&gt;</span><span class='cp'>&lt;%=</span> <span class='n'>user</span><span class='o'>.</span><span class='n'>name</span> <span class='cp'>%&gt;</span><span class='x'>&lt;/h2&gt;</span>
<span class='cp'>&lt;%</span> <span class='k'>for</span><span class='p'>(</span> <span class='n'>var</span> <span class='n'>i</span> <span class='o'>=</span> <span class='mi'>0</span><span class='p'>;</span> <span class='n'>i</span> <span class='o'>&lt;</span> <span class='n'>todos</span><span class='o'>.</span><span class='n'>length</span><span class='p'>;</span> <span class='n'>i</span><span class='o'>++</span><span class='p'>)</span> <span class='p'>{</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>  &lt;li&gt;</span><span class='cp'>&lt;%=</span> <span class='n'>todos</span><span class='o'>[</span><span class='n'>i</span><span class='o'>].</span><span class='n'>name</span> <span class='cp'>%&gt;</span><span class='x'>&lt;/li&gt;</span>
<span class='cp'>&lt;%</span> <span class='p'>}</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>&lt;/script&gt;</span>
</code></pre>
</div>
<p>Can be inserted into the document with:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>can</span><span class='p'>.</span><span class='nx'>view</span><span class='p'>(</span><span class='s1'>&#39;todosEJS&#39;</span><span class='p'>,</span> <span class='p'>{</span>
  <span class='nx'>todos</span> <span class='o'>:</span> <span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findAll</span><span class='p'>(),</span>
  <span class='nx'>user</span><span class='o'>:</span> <span class='nx'>User</span><span class='p'>.</span><span class='nx'>findOne</span><span class='p'>({</span> <span class='nx'>id</span><span class='o'>:</span> <span class='mi'>5</span> <span class='p'>})</span>
<span class='p'>}).</span><span class='nx'>then</span><span class='p'>(</span><span class='kd'>function</span><span class='p'>(</span> <span class='nx'>frag</span> <span class='p'>){</span>
  <span class='nb'>document</span><span class='p'>.</span><span class='nx'>getElementById</span><span class='p'>(</span><span class='s1'>&#39;todos&#39;</span><span class='p'>)</span>
          <span class='p'>.</span><span class='nx'>appendChild</span><span class='p'>(</span><span class='nx'>frag</span><span class='p'>);</span>
<span class='p'>})</span>
</code></pre>
</div>
<h3 id='magic_tags'>Magic Tags</h3>

<p>EJS uses 5 types of magic tags:</p>

<p><strong><code>&lt;% CODE %&gt;</code></strong> - Runs JS Code.</p>

<p>This type of magic tag does not modify the template but is used for JS control statements like for-loops, if/else, switch, declaring variables, etc. Pretty much any JS code is valid. Examples:</p>
<div class='highlight'><pre><code class='erb'><span class='x'>&lt;!-- check if there are no todos --&gt;</span>
<span class='cp'>&lt;%</span> <span class='k'>if</span><span class='p'>(</span> <span class='n'>todos</span><span class='o'>.</span><span class='n'>attr</span><span class='p'>(</span><span class='s1'>&#39;length&#39;</span><span class='p'>)</span> <span class='o'>===</span> <span class='mi'>0</span> <span class='p'>)</span> <span class='p'>{</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>    &lt;li&gt;You have no todos&lt;/li&gt;</span>
<span class='cp'>&lt;%</span> <span class='p'>}</span> <span class='k'>else</span> <span class='p'>{</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>    </span><span class='cp'>&lt;%</span> <span class='n'>list</span><span class='p'>(</span><span class='n'>todos</span><span class='p'>,</span> <span class='n'>function</span><span class='p'>(){</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>        &lt;li&gt; .... &lt;/li&gt;</span>
<span class='x'>    </span><span class='cp'>&lt;%</span> <span class='p'>})</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='cp'>&lt;%</span> <span class='p'>}</span> <span class='cp'>%&gt;</span><span class='x' />

<span class='x'>&lt;!-- create and use a variable --&gt;</span>
<span class='cp'>&lt;%</span> <span class='n'>var</span> <span class='n'>person</span> <span class='o'>=</span> <span class='n'>todo</span><span class='o'>.</span><span class='n'>attr</span><span class='p'>(</span><span class='s1'>&#39;person&#39;</span><span class='p'>)</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>&lt;span&gt;</span><span class='cp'>&lt;%=</span> <span class='n'>person</span><span class='o'>.</span><span class='n'>attr</span><span class='p'>(</span><span class='s1'>&#39;name&#39;</span><span class='p'>)</span> <span class='cp'>%&gt;</span><span class='x'>&lt;span&gt;</span>
</code></pre>
</div>
<p><strong><code>&lt;%= CODE %&gt;</code></strong> - Runs a JS statement and writes the <strong>escaped</strong> result into the result of the template.</p>

<p>The following results in the user seeing <code>my favorite element is &amp;lt;b&gt;B&amp;lt;b&gt;.</code> and not <code>my favorite element is <B>B</B>.</code>.</p>

<pre><code> &lt;div&gt;my favorite element is &lt;%= &#39;&lt;b&gt;B&lt;/b&gt;&#39; %&gt;.&lt;/div&gt;</code></pre>

<p>This protects you against <a href='http://en.wikipedia.org/wiki/Cross-site_scripting'>cross-site scripting</a> attacks.</p>

<p><strong><code>&lt;%== CODE %&gt;</code></strong> - Runs a JS statement and writes the <strong>unescaped</strong> result into the result of the template.</p>

<p>The following results in <code>my favorite element is <B>B</B>.</code>. Using <code>&lt;%==</code> is useful for sub-templates.</p>

<pre><code>&lt;div&gt;my favorite element is &lt;%== &#39;&lt;B&gt;B&lt;/B&gt;&#39; %&gt;.&lt;/div&gt;</code></pre>

<p>Use <code>&lt;%== CODE %&gt;</code> when rendering subtemplates:</p>
<div class='highlight'><pre><code class='erb'><span class='cp'>&lt;%</span> <span class='k'>for</span><span class='p'>(</span> <span class='n'>var</span> <span class='n'>i</span> <span class='o'>=</span> <span class='mi'>0</span><span class='p'>;</span> <span class='n'>i</span> <span class='o'>&lt;</span> <span class='n'>todos</span><span class='o'>.</span><span class='n'>length</span><span class='p'>;</span> <span class='n'>i</span><span class='o'>++</span><span class='p'>)</span> <span class='p'>{</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>  &lt;li&gt;</span><span class='cp'>&lt;%=</span><span class='o'>=</span> <span class='n'>can</span><span class='o'>.</span><span class='n'>view</span><span class='o'>.</span><span class='n'>render</span><span class='p'>(</span><span class='s1'>&#39;todoEJS&#39;</span><span class='p'>,</span> <span class='n'>todos</span><span class='o'>[</span><span class='n'>i</span><span class='o'>]</span><span class='p'>)</span> <span class='cp'>%&gt;</span><span class='x'>&lt;/li&gt;</span>
<span class='cp'>&lt;%</span> <span class='p'>}</span> <span class='cp'>%&gt;</span><span class='x' />
</code></pre>
</div>
<h3 id='live_binding'>Live Binding</h3>

<p><strong>can.EJS</strong> will automatically update itself when <a href='#can_observe'>can.Observes</a> change. To enable live-binding, use <a href='#!can_observe-attr'>attr</a> to read properties. For example, the following template will update todo&#8217;s name when it change:</p>
<div class='highlight'><pre><code class='erb'><span class='x'>  &lt;li&gt;</span><span class='cp'>&lt;%=</span> <span class='n'>todo</span><span class='o'>.</span><span class='n'>attr</span><span class='p'>(</span><span class='s1'>&#39;name&#39;</span><span class='p'>)</span> <span class='cp'>%&gt;</span><span class='x'>&lt;/li&gt;</span>
</code></pre>
</div>
<p>Notice <code>attr(&#39;name&#39;)</code>. This sets up live-binding. If you change the todo&#8217;s name, the <code>&lt;li&gt;</code> will automatically be updated:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>todo</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>(</span><span class='s2'>&quot;Clean the toilet&quot;</span><span class='p'>);</span>
</code></pre>
</div>
<p>Live-binding works by wrapping the code inside the magic tags with a function to call when the attribute (or attributes) are changed. This is important to understand because a template like this will not work:</p>
<div class='highlight'><pre><code class='erb'><span class='cp'>&lt;%</span> <span class='k'>for</span><span class='p'>(</span> <span class='n'>var</span> <span class='n'>i</span> <span class='o'>=</span> <span class='mi'>0</span><span class='p'>;</span> <span class='n'>i</span> <span class='o'>&lt;</span> <span class='n'>todos</span><span class='o'>.</span><span class='n'>length</span><span class='p'>;</span> <span class='n'>i</span><span class='o'>++</span><span class='p'>)</span> <span class='p'>{</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>  &lt;li&gt;</span><span class='cp'>&lt;%=</span> <span class='n'>todos</span><span class='o'>[</span><span class='n'>i</span><span class='o'>].</span><span class='n'>attr</span><span class='p'>(</span><span class='s1'>&#39;name&#39;</span><span class='p'>)</span> <span class='cp'>%&gt;</span><span class='x'>&lt;/li&gt;</span>
<span class='cp'>&lt;%</span> <span class='p'>}</span> <span class='cp'>%&gt;</span><span class='x' />
</code></pre>
</div>
<p>This does not work because when the function wrapping <code>todos[i].attr(&#39;name&#39;)</code> is called, <code>i</code> will be <strong>3</strong> not the index of the desired todo. Fix this by using a closure like:</p>
<div class='highlight'><pre><code class='erb'><span class='cp'>&lt;%</span> <span class='vg'>$.</span><span class='n'>each</span><span class='p'>(</span><span class='n'>todos</span><span class='p'>,</span> <span class='n'>function</span><span class='p'>(</span><span class='n'>i</span><span class='p'>,</span> <span class='n'>todo</span><span class='p'>){</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>  &lt;li&gt;</span><span class='cp'>&lt;%=</span> <span class='n'>todo</span><span class='o'>.</span><span class='n'>attr</span><span class='p'>(</span><span class='s1'>&#39;name&#39;</span><span class='p'>)</span> <span class='cp'>%&gt;</span><span class='x'>&lt;/li&gt;</span>
<span class='cp'>&lt;%</span> <span class='p'>})</span> <span class='cp'>%&gt;</span><span class='x' />
</code></pre>
</div>
<h3 id='list_'>list <code>list( observeList, iterator( item, index ) )</code></h3>

<p>If you want to make the previous template update when todos are added or removed, could bind to length like:</p>
<div class='highlight'><pre><code class='erb'><span class='cp'>&lt;%</span> <span class='n'>todos</span><span class='o'>.</span><span class='n'>bind</span><span class='p'>(</span><span class='s2'>&quot;length&quot;</span><span class='p'>,</span> <span class='n'>function</span><span class='p'>(){});</span>
   <span class='vg'>$.</span><span class='n'>each</span><span class='p'>(</span><span class='n'>todos</span><span class='p'>,</span> <span class='n'>function</span><span class='p'>(</span><span class='n'>i</span><span class='p'>,</span> <span class='n'>todo</span><span class='p'>){</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>      &lt;li&gt;</span><span class='cp'>&lt;%=</span> <span class='n'>todo</span><span class='o'>.</span><span class='n'>attr</span><span class='p'>(</span><span class='s1'>&#39;name&#39;</span><span class='p'>)</span> <span class='cp'>%&gt;</span><span class='x'>&lt;/li&gt;</span>
<span class='cp'>&lt;%</span> <span class='p'>})</span> <span class='cp'>%&gt;</span><span class='x' />
</code></pre>
</div>
<p>Or simply use EJS&#8217;s <code>list</code> helper method like:</p>
<div class='highlight'><pre><code class='erb'><span class='cp'>&lt;%</span> <span class='n'>list</span><span class='p'>(</span><span class='n'>todos</span><span class='p'>,</span> <span class='n'>function</span><span class='p'>(</span><span class='n'>todo</span><span class='p'>){</span> <span class='cp'>%&gt;</span><span class='x' />
<span class='x'>  &lt;li&gt;</span><span class='cp'>&lt;%=</span> <span class='n'>todo</span><span class='o'>.</span><span class='n'>attr</span><span class='p'>(</span><span class='s1'>&#39;name&#39;</span><span class='p'>)</span> <span class='cp'>%&gt;</span><span class='x'>&lt;/li&gt;</span>
<span class='cp'>&lt;%</span> <span class='p'>})</span> <span class='cp'>%&gt;</span><span class='x' />
</code></pre>
</div>
<p>Now when todos are added or removed from the todo list, the template&#8217;s HTML is updated:</p>
<div class='highlight'><pre><code class='javascript'><span class='c1'>// add an item</span>
<span class='nx'>todos</span><span class='p'>.</span><span class='nx'>push</span><span class='p'>(</span> <span class='k'>new</span> <span class='nx'>Todo</span><span class='p'>({</span><span class='nx'>name</span> <span class='o'>:</span> <span class='s2'>&quot;file taxes&quot;</span><span class='p'>})</span> <span class='p'>);</span>

<span class='c1'>// destroying an item removes it from Model.Lists</span>
<span class='nx'>todos</span><span class='p'>[</span><span class='mi'>0</span><span class='p'>].</span><span class='nx'>destroy</span><span class='p'>()</span>
</code></pre>
</div>
<h2 id='cancontrol_'>can.Control <code>can.Control(classProps, prototypeProps)</code></h2>

<p><a href='http://donejs.com/docs.html#!can.Control'>can.Control</a> creates organized, memory-leak free, rapidly performing, stateful controls. Use it to create UI controls like tabs, grids, and contextmenus and used to organize them into higher-order business rules with <a href='http://donejs.com/docs.html#!can.route'>can.route</a>. It can serve as a traditional view and a traditional controller.</p>

<p>The following examples make a basic todos widget that lists todos and lets us destroy them. Create a control constructor function of your own by extending <code>can.Control</code>.</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Todos</span> <span class='o'>=</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Control</span><span class='p'>({</span>
  <span class='s2'>&quot;init&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>element</span> <span class='p'>,</span> <span class='nx'>options</span> <span class='p'>){</span>
    <span class='k'>this</span><span class='p'>.</span><span class='nx'>element</span><span class='p'>.</span><span class='nx'>html</span><span class='p'>(</span><span class='s1'>&#39;todos.ejs&#39;</span><span class='p'>,</span> <span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findAll</span><span class='p'>()</span> <span class='p'>)</span>
  <span class='p'>}</span>
<span class='p'>})</span>
</code></pre>
</div>
<p>Create an instance of the Todos control the <code>#todos</code> element with:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>todosControl</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Todos</span><span class='p'>(</span><span class='s1'>&#39;#todos&#39;</span><span class='p'>,</span> <span class='p'>{});</span>
</code></pre>
</div>
<h3 id='init_'>init <code>can.Control.prototype.init(element, options)</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Control:init'>Init</a> is called when a new can.Control instance is created. It&#8217;s called with:</p>

<ul>
<li><strong>element</strong> - The wrapped element passed to the control. Control accepts a raw HTMLElement, a css selector, or a NodeList. This is set as <strong>this.element</strong> on the control instance.</li>

<li><strong>options</strong> - The second argument passed to new Control, extended with the can.Control&#8217;s static <strong>defaults</strong>. This is set as <strong>this.options</strong> on the control instance.</li>
</ul>

<p>and any other arguments passed to <code>new can.Control()</code>. For example:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Todos</span> <span class='o'>=</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Control</span><span class='p'>({</span>
  <span class='nx'>defaults</span> <span class='o'>:</span> <span class='p'>{</span><span class='nx'>template</span><span class='o'>:</span> <span class='s1'>&#39;todos.ejs&#39;</span><span class='p'>}</span>
<span class='p'>},{</span>
  <span class='s2'>&quot;init&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>element</span> <span class='p'>,</span> <span class='nx'>options</span> <span class='p'>){</span>
    <span class='nx'>element</span><span class='p'>.</span><span class='nx'>html</span><span class='p'>(</span><span class='nx'>options</span><span class='p'>.</span><span class='nx'>template</span><span class='p'>,</span> <span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findAll</span><span class='p'>()</span> <span class='p'>)</span>
  <span class='p'>}</span>
<span class='p'>})</span>

<span class='c1'>// create a Todos with default options</span>
<span class='k'>new</span> <span class='nx'>Todos</span><span class='p'>(</span> <span class='nb'>document</span><span class='p'>.</span><span class='nx'>body</span><span class='p'>.</span><span class='nx'>firstElementChild</span> <span class='p'>);</span>

<span class='c1'>// overwrite the template option</span>
<span class='k'>new</span> <span class='nx'>Todos</span><span class='p'>(</span> <span class='nx'>$</span><span class='p'>(</span><span class='s1'>&#39;#todos&#39;</span><span class='p'>),</span> <span class='p'>{</span><span class='nx'>template</span><span class='o'>:</span> <span class='s1'>&#39;specialTodos.ejs&#39;</span><span class='p'>})</span>
</code></pre>
</div>
<h3 id='element_'>element <code>this.element</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Controll.prototype.element'>this.element</a> is the a nodelist of a single element, the element the control is created on.</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>todosControl</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Todos</span><span class='p'>(</span> <span class='nb'>document</span><span class='p'>.</span><span class='nx'>body</span><span class='p'>.</span><span class='nx'>firstElementChild</span> <span class='p'>);</span>
<span class='nx'>todosControl</span><span class='p'>.</span><span class='nx'>element</span><span class='p'>[</span><span class='mi'>0</span><span class='p'>]</span> <span class='c1'>//-&gt; document.body.firstElementChild</span>
</code></pre>
</div>
<p>Each library wraps the element differently. If you are using jQuery, the element is wrapped with <code>jQuery( element )</code>.</p>

<h3 id='options_'>options <code>this.options</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Control.prototype.options'>this.options</a> is the second argument passed to <code>new can.Control()</code> merged with the control&#8217;s static <strong>defaults</strong> property.</p>

<h3 id='listening_to_events'>Listening to events</h3>

<p>Controller automatically binds prototype methods that look like event handlers. Listen to <strong>click</strong>s on <code>&lt;li&gt;</code> elements like:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Todos</span> <span class='o'>=</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Control</span><span class='p'>({</span>
<span class='s2'>&quot;init&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>element</span> <span class='p'>,</span> <span class='nx'>options</span> <span class='p'>){</span>
  <span class='k'>this</span><span class='p'>.</span><span class='nx'>element</span><span class='p'>.</span><span class='nx'>html</span><span class='p'>(</span><span class='s1'>&#39;todos.ejs&#39;</span><span class='p'>,</span> <span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findAll</span><span class='p'>()</span> <span class='p'>)</span>
<span class='p'>},</span>
<span class='s2'>&quot;li click&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>li</span><span class='p'>,</span> <span class='nx'>event</span><span class='p'>){</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span><span class='s2'>&quot;You clicked&quot;</span><span class='p'>,</span> <span class='nx'>li</span><span class='p'>.</span><span class='nx'>text</span><span class='p'>()</span> <span class='p'>)</span>
  
  <span class='c1'>// let other controls know what happened</span>
  <span class='nx'>li</span><span class='p'>.</span><span class='nx'>trigger</span><span class='p'>(</span><span class='s1'>&#39;selected&#39;</span><span class='p'>);</span>
<span class='p'>}</span>
<span class='p'>})</span>
</code></pre>
</div>
<p>When an <code>&lt;li&gt;</code> is clicked, <code>&quot;li click&quot;</code> is called with:</p>

<ul>
<li>The library-wrapped <strong>element</strong> that was clicked.</li>

<li>The <strong>event</strong> data</li>
</ul>

<p>Controller uses event delegation, so you can add <code>&lt;li&gt;</code>s without needing to rebind event handlers.</p>

<p>To destroy a todo when it&#8217;s <code>&lt;a href=&#39;javascript:// class=&#39;destroy&#39;&gt;</code> link is clicked:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Todos</span> <span class='o'>=</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Control</span><span class='p'>({</span>
<span class='s2'>&quot;init&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>element</span> <span class='p'>,</span> <span class='nx'>options</span> <span class='p'>){</span>
  <span class='k'>this</span><span class='p'>.</span><span class='nx'>element</span><span class='p'>.</span><span class='nx'>html</span><span class='p'>(</span><span class='s1'>&#39;todos.ejs&#39;</span><span class='p'>,</span> <span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findAll</span><span class='p'>()</span> <span class='p'>)</span>
<span class='p'>},</span>
<span class='s2'>&quot;li click&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>li</span><span class='p'>){</span>
  <span class='nx'>li</span><span class='p'>.</span><span class='nx'>trigger</span><span class='p'>(</span><span class='s1'>&#39;selected&#39;</span><span class='p'>,</span> <span class='nx'>li</span><span class='p'>.</span><span class='nx'>model</span><span class='p'>()</span> <span class='p'>);</span>
<span class='p'>},</span>
<span class='s2'>&quot;li .destroy click&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>el</span><span class='p'>,</span> <span class='nx'>ev</span><span class='p'>){</span>
  <span class='c1'>// get the li element that has the model</span>
  <span class='kd'>var</span> <span class='nx'>li</span> <span class='o'>=</span> <span class='nx'>el</span><span class='p'>.</span><span class='nx'>closest</span><span class='p'>(</span><span class='s1'>&#39;.todo&#39;</span><span class='p'>);</span>
  
  <span class='c1'>// get the model</span>
  <span class='kd'>var</span> <span class='nx'>todo</span> <span class='o'>=</span> <span class='nx'>li</span><span class='p'>.</span><span class='nx'>model</span><span class='p'>()</span>
  
  <span class='c1'>//destroy it</span>
  <span class='nx'>todo</span><span class='p'>.</span><span class='nx'>destroy</span><span class='p'>(</span><span class='kd'>function</span><span class='p'>(){</span>
    <span class='c1'>// remove the element</span>
    <span class='nx'>li</span><span class='p'>.</span><span class='nx'>remove</span><span class='p'>();</span>
  <span class='p'>});</span>
<span class='p'>}</span>
<span class='p'>})</span>
</code></pre>
</div>
<h3 id='templated_event_handlers_pt_1_'>Templated Event Handlers Pt 1 <code>&quot;{optionName}&quot;</code></h3>

<p>Customize event handler behavior with <code>&quot;{NAME}&quot;</code> in the event handler name. The following allows customization of the event that destroys a todo:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Todos</span> <span class='o'>=</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Control</span><span class='p'>(</span><span class='s2'>&quot;Todos&quot;</span><span class='p'>,{</span>
  <span class='s2'>&quot;init&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>element</span> <span class='p'>,</span> <span class='nx'>options</span> <span class='p'>){</span> <span class='p'>...</span> <span class='p'>},</span>
  <span class='s2'>&quot;li click&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>li</span><span class='p'>){</span> <span class='p'>...</span> <span class='p'>},</span>
  
  <span class='s2'>&quot;li .destroy {destroyEvent}&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>el</span><span class='p'>,</span> <span class='nx'>ev</span><span class='p'>){</span> 
    <span class='c1'>// previous destroy code here</span>
  <span class='p'>}</span>
<span class='p'>})</span>

<span class='c1'>// create Todos with this.options.destroyEvent</span>
<span class='k'>new</span> <span class='nx'>Todos</span><span class='p'>(</span><span class='s2'>&quot;#todos&quot;</span><span class='p'>,{</span><span class='nx'>destroyEvent</span><span class='o'>:</span> <span class='s2'>&quot;mouseenter&quot;</span><span class='p'>})</span>
</code></pre>
</div>
<p>Values inside <code>{NAME}</code> are looked up on the control&#8217;s <code>this.options</code> and then the <code>window</code>. For example, we could customize it instead like:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Todos</span> <span class='o'>=</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Control</span><span class='p'>(</span><span class='s2'>&quot;Todos&quot;</span><span class='p'>,{</span>
  <span class='s2'>&quot;init&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>element</span> <span class='p'>,</span> <span class='nx'>options</span> <span class='p'>){</span> <span class='p'>...</span> <span class='p'>},</span>
  <span class='s2'>&quot;li click&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>li</span><span class='p'>){</span> <span class='p'>...</span> <span class='p'>},</span>
  
  <span class='s2'>&quot;li .destroy {Events.destroy}&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>el</span><span class='p'>,</span> <span class='nx'>ev</span><span class='p'>){</span> 
    <span class='c1'>// previous destroy code here</span>
  <span class='p'>}</span>
<span class='p'>})</span>

<span class='c1'>// Events config</span>
<span class='nx'>Events</span> <span class='o'>=</span> <span class='p'>{</span><span class='nx'>destroy</span><span class='o'>:</span> <span class='s2'>&quot;click&quot;</span><span class='p'>};</span>

<span class='c1'>// Events.destroy is looked up on the window.</span>
<span class='k'>new</span> <span class='nx'>Todos</span><span class='p'>(</span><span class='s2'>&quot;#todos&quot;</span><span class='p'>)</span>
</code></pre>
</div>
<p>The selector can also be templated.</p>

<h3 id='templated_event_handlers_pt_2_'>Templated Event Handlers Pt 2 <code>&quot;{objectName}&quot;</code></h3>

<p>Controller can also bind to objects other than <code>this.element</code> with templated event handlers. This is <strong>especially critical</strong> for avoiding memory leaks that are so common among MVC applications.</p>

<p>If the value inside <code>{NAME}</code> is an object, that object will be bound to. For example, the following tooltip listens to clicks on the window:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Tooltip</span><span class='p'>({</span>
  <span class='s2'>&quot;{window} click&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>el</span><span class='p'>,</span> <span class='nx'>ev</span><span class='p'>){</span>
    <span class='c1'>// hide only if we clicked outside the tooltip</span>
    <span class='k'>if</span><span class='p'>(</span><span class='o'>!</span> <span class='k'>this</span><span class='p'>.</span><span class='nx'>element</span><span class='p'>.</span><span class='nx'>has</span><span class='p'>(</span><span class='nx'>ev</span><span class='p'>.</span><span class='nx'>target</span> <span class='p'>)</span> <span class='p'>{</span>
      <span class='k'>this</span><span class='p'>.</span><span class='nx'>element</span><span class='p'>.</span><span class='nx'>remove</span><span class='p'>();</span>
    <span class='p'>}</span>
  <span class='p'>}</span>
<span class='p'>})</span>

<span class='c1'>// create a Tooltip</span>
<span class='k'>new</span> <span class='nx'>Tooltip</span><span class='p'>(</span> <span class='nx'>$</span><span class='p'>(</span><span class='s1'>&#39;&lt;div&gt;INFO&lt;/div&gt;&#39;</span><span class='p'>).</span><span class='nx'>appendTo</span><span class='p'>(</span><span class='nx'>el</span><span class='p'>)</span> <span class='p'>)</span>
</code></pre>
</div>
<p>This is convenient when needing to listen to model updates. Instead of adding a callback to <code>todo.destroy(cb)</code>, we should be listening to <strong>destroyed</strong> events. We&#8217;ll handle <strong>updated</strong> too:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Todos</span> <span class='o'>=</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Control</span><span class='p'>({</span>
  <span class='s2'>&quot;init&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>element</span> <span class='p'>,</span> <span class='nx'>options</span> <span class='p'>){</span>
    <span class='k'>this</span><span class='p'>.</span><span class='nx'>element</span><span class='p'>.</span><span class='nx'>html</span><span class='p'>(</span><span class='s1'>&#39;todos.ejs&#39;</span><span class='p'>,</span> <span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findAll</span><span class='p'>()</span> <span class='p'>)</span>
  <span class='p'>},</span>
  <span class='s2'>&quot;li click&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>li</span><span class='p'>){</span>
    <span class='nx'>li</span><span class='p'>.</span><span class='nx'>trigger</span><span class='p'>(</span><span class='s1'>&#39;selected&#39;</span><span class='p'>,</span> <span class='nx'>li</span><span class='p'>.</span><span class='nx'>model</span><span class='p'>()</span> <span class='p'>);</span>
  <span class='p'>},</span>
  <span class='s2'>&quot;li .destroy click&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>el</span><span class='p'>,</span> <span class='nx'>ev</span><span class='p'>){</span>
    <span class='nx'>el</span><span class='p'>.</span><span class='nx'>closest</span><span class='p'>(</span><span class='s1'>&#39;.todo&#39;</span><span class='p'>)</span>
      <span class='p'>.</span><span class='nx'>model</span><span class='p'>()</span>
      <span class='p'>.</span><span class='nx'>destroy</span><span class='p'>();</span>
    <span class='nx'>ev</span><span class='p'>.</span><span class='nx'>stopPropagation</span><span class='p'>();</span>
  <span class='p'>},</span>
  <span class='s2'>&quot;{Todo} destroyed&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>Todo</span><span class='p'>,</span> <span class='nx'>ev</span><span class='p'>,</span> <span class='nx'>destroyedTodo</span><span class='p'>){</span>
    <span class='nx'>destroyedTodo</span><span class='p'>.</span><span class='nx'>elements</span><span class='p'>(</span><span class='k'>this</span><span class='p'>.</span><span class='nx'>element</span><span class='p'>)</span>
                 <span class='p'>.</span><span class='nx'>remove</span><span class='p'>();</span>
  <span class='p'>},</span>
  <span class='s2'>&quot;{Todo} updated&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>Todo</span><span class='p'>,</span> <span class='nx'>ev</span><span class='p'>,</span> <span class='nx'>updatedTodo</span><span class='p'>){</span>
    <span class='nx'>updatedTodo</span><span class='p'>.</span><span class='nx'>elements</span><span class='p'>(</span><span class='k'>this</span><span class='p'>.</span><span class='nx'>element</span><span class='p'>)</span>
               <span class='p'>.</span><span class='nx'>replaceWith</span><span class='p'>(</span><span class='s1'>&#39;todos.ejs&#39;</span><span class='p'>,[</span><span class='nx'>updatedTodo</span><span class='p'>]);</span>
  <span class='p'>}</span>
<span class='p'>})</span>

<span class='k'>new</span> <span class='nx'>Todos</span><span class='p'>(</span><span class='s2'>&quot;#todos&quot;</span><span class='p'>);</span>
</code></pre>
</div>
<p>This is better because it removes the todo&#8217;s element from the page even if another widget destroyed the todo. Also, this works very well with real-time architectures.</p>

<h3 id='destroy_'>destroy <code>control.destroy()</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Control.prototype.destroy'>can.Control.prototype.destroy</a> unbinds a control&#8217;s event handlers and releases its element, but does not remove the element from the page.</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>todo</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Todos</span><span class='p'>(</span><span class='s2'>&quot;#todos&quot;</span><span class='p'>)</span>
<span class='nx'>todo</span><span class='p'>.</span><span class='nx'>destroy</span><span class='p'>();</span>
</code></pre>
</div>
<p>When a control&#8217;s element is removed from the page <strong>destroy</strong> is called automatically.</p>
<div class='highlight'><pre><code class='javascript'><span class='k'>new</span> <span class='nx'>Todos</span><span class='p'>(</span><span class='s2'>&quot;#todos&quot;</span><span class='p'>)</span>
<span class='nx'>$</span><span class='p'>(</span><span class='s2'>&quot;#todos&quot;</span><span class='p'>).</span><span class='nx'>remove</span><span class='p'>();</span>
</code></pre>
</div>
<p>All event handlers bound with Controller are unbound when the control is destroyed (or its element is removed).</p>

<p><em>Brief aside on destroy and templated event binding. Taken together, templated event binding, and control&#8217;s automatic clean-up make it almost impossible to write leaking applications. An application that uses only templated event handlers on controls within the body could free up all data by calling <code>$(document.body).empty()</code>.</em></p>

<h3 id='update_'>update <code>control.update(options)</code></h3>

<p><a href='http://donejs.com/docs.html#!can.Control.prototype.update'>can.Control.prototype.update</a> updates a control&#8217;s <code>this.options</code> and rebinds all event handlers.This is useful when you want to listen to a specific model:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Editor</span> <span class='o'>=</span> <span class='nx'>$</span><span class='p'>.</span><span class='nx'>Controller</span><span class='p'>({</span>
  <span class='nx'>update</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>options</span><span class='p'>){</span>
    <span class='k'>this</span><span class='p'>.</span><span class='nx'>_super</span><span class='p'>(</span><span class='nx'>options</span><span class='p'>)</span>
    <span class='k'>this</span><span class='p'>.</span><span class='nx'>setName</span><span class='p'>();</span>
  <span class='p'>},</span>
  <span class='c1'>// a helper that sets the value of the input</span>
  <span class='c1'>// to the todo&#39;s name</span>
  <span class='nx'>setName</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(){</span>
    <span class='k'>this</span><span class='p'>.</span><span class='nx'>element</span><span class='p'>.</span><span class='nx'>val</span><span class='p'>(</span><span class='k'>this</span><span class='p'>.</span><span class='nx'>options</span><span class='p'>.</span><span class='nx'>todo</span><span class='p'>.</span><span class='nx'>name</span><span class='p'>);</span>
  <span class='p'>},</span>
  <span class='c1'>// listen for changes in the todo</span>
  <span class='c1'>// and update the input</span>
  <span class='s2'>&quot;{todo} updated&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(){</span>
    <span class='k'>this</span><span class='p'>.</span><span class='nx'>setName</span><span class='p'>();</span>
  <span class='p'>},</span>
  <span class='c1'>// when the input changes</span>
  <span class='c1'>// update the todo instance</span>
  <span class='s2'>&quot;change&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(){</span>
    <span class='kd'>var</span> <span class='nx'>todo</span> <span class='o'>=</span> <span class='k'>this</span><span class='p'>.</span><span class='nx'>options</span><span class='p'>.</span><span class='nx'>todo</span>
    <span class='nx'>todo</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>(</span><span class='s1'>&#39;name&#39;</span><span class='p'>,</span><span class='k'>this</span><span class='p'>.</span><span class='nx'>element</span><span class='p'>.</span><span class='nx'>val</span><span class='p'>()</span> <span class='p'>)</span>
    <span class='nx'>todo</span><span class='p'>.</span><span class='nx'>save</span><span class='p'>();</span>
  <span class='p'>}</span>
<span class='p'>});</span>

<span class='kd'>var</span> <span class='nx'>todo1</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Todo</span><span class='p'>({</span><span class='nx'>id</span><span class='o'>:</span> <span class='mi'>6</span><span class='p'>,</span> <span class='nx'>name</span><span class='o'>:</span> <span class='s2'>&quot;trash&quot;</span><span class='p'>}),</span>
    <span class='nx'>todo2</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Todo</span><span class='p'>({</span><span class='nx'>id</span><span class='o'>:</span> <span class='mi'>6</span><span class='p'>,</span> <span class='nx'>name</span><span class='o'>:</span> <span class='s2'>&quot;dishes&quot;</span><span class='p'>});</span>

<span class='c1'>// create the editor;</span>
<span class='kd'>var</span> <span class='nx'>editor</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Editor</span><span class='p'>(</span><span class='s2'>&quot;#editor&quot;</span><span class='p'>);</span>

<span class='c1'>// show the first todo</span>
<span class='nx'>editor</span><span class='p'>.</span><span class='nx'>update</span><span class='p'>({</span><span class='nx'>todo</span><span class='o'>:</span> <span class='nx'>todo1</span><span class='p'>})</span>

<span class='c1'>// switch it to the second todo</span>
<span class='nx'>editor</span><span class='p'>.</span><span class='nx'>update</span><span class='p'>({</span><span class='nx'>todo</span><span class='o'>:</span> <span class='nx'>todo2</span><span class='p'>});</span>
</code></pre>
</div>
<p>Notice that because we are overwriting <code>update</code>, we must call <strong>_super</strong>.</p>

<h2 id='canroute'>can.route</h2>

<p><a href='http://donejs.com/docs.html#!can.route'>can.route</a> is the core of donejs&#8217;s routing functionality. It is a <a href='http://donejs.com/docs.html#!can.Observe'>can.Observe</a> that updates <code>window.location.hash</code> when it&#8217;s properties change and updates its properties when <code>window.location.hash</code> changes. It allows very sophisticated routing behavior &#8230; too sophisticated for this guide. But, it also handles the basics with ease.</p>

<p>Listen to routes in controls with special &#8220;route&#8221; events like:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Routing</span> <span class='o'>=</span> <span class='nx'>$</span><span class='p'>.</span><span class='nx'>Controller</span><span class='p'>({</span>
  <span class='s2'>&quot;route&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(){</span>
    <span class='c1'>// matches empty hash, #, or #!</span>
  <span class='p'>},</span>
  <span class='s2'>&quot;todos/:id route&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>data</span><span class='p'>){</span>
    <span class='c1'>// matches routes like #!todos/5</span>
  <span class='p'>}</span>
<span class='p'>})</span>

<span class='c1'>// create routing control</span>
<span class='k'>new</span> <span class='nx'>Routing</span><span class='p'>(</span><span class='nb'>document</span><span class='p'>.</span><span class='nx'>body</span><span class='p'>);</span>
</code></pre>
</div>
<p>The <code>route</code> methods get called back with the route <strong>data</strong>. The empty <code>&quot;route&quot;</code> will be called with no data. But, <code>&quot;todos/:id route&quot;</code> will be called with data like: <code>{id: 6}</code>.</p>

<p>We can update the route by changing $.route&#8217;s data like:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>$</span><span class='p'>.</span><span class='nx'>route</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>(</span><span class='s1'>&#39;id&#39;</span><span class='p'>,</span><span class='s1'>&#39;6&#39;</span><span class='p'>)</span> <span class='c1'>// location.hash = #!todos/6</span>
</code></pre>
</div>
<p>Or we can set the hash ourselves like</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>hash</span> <span class='o'>=</span> <span class='nx'>$</span><span class='p'>.</span><span class='nx'>route</span><span class='p'>.</span><span class='nx'>url</span><span class='p'>({</span><span class='nx'>id</span><span class='o'>:</span> <span class='mi'>7</span><span class='p'>})</span> <span class='c1'>// #!todos/7</span>
<span class='nx'>location</span><span class='p'>.</span><span class='nx'>hash</span> <span class='o'>=</span> <span class='nx'>hash</span><span class='p'>;</span>
</code></pre>
</div>
<p>The following enhances the Routing control to listen for <code>&quot;.todo selected&quot;</code> events and change the <code>$.route</code>. When the $.route changes, it retrieves the todo from the server and updates the editor widget.</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>Routing</span> <span class='o'>=</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Control</span><span class='p'>({</span>
  <span class='nx'>init</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(){</span>
    <span class='k'>this</span><span class='p'>.</span><span class='nx'>editor</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>Editor</span><span class='p'>(</span><span class='s2'>&quot;#editor&quot;</span><span class='p'>)</span>
    <span class='k'>new</span> <span class='nx'>Todos</span><span class='p'>(</span><span class='s2'>&quot;#todos&quot;</span><span class='p'>);</span>
  <span class='p'>},</span>
  <span class='c1'>// the index page</span>
  <span class='s2'>&quot;route&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(){</span>
     <span class='nx'>$</span><span class='p'>(</span><span class='s2'>&quot;#editor&quot;</span><span class='p'>).</span><span class='nx'>hide</span><span class='p'>();</span>
  <span class='p'>},</span>
  <span class='s2'>&quot;todos/:id route&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>data</span><span class='p'>){</span>
    <span class='nx'>$</span><span class='p'>(</span><span class='s2'>&quot;#editor&quot;</span><span class='p'>).</span><span class='nx'>show</span><span class='p'>();</span>
    <span class='nx'>Todo</span><span class='p'>.</span><span class='nx'>findOne</span><span class='p'>(</span><span class='nx'>data</span><span class='p'>,</span> <span class='nx'>$</span><span class='p'>.</span><span class='nx'>proxy</span><span class='p'>(</span><span class='kd'>function</span><span class='p'>(</span><span class='nx'>todo</span><span class='p'>){</span>
      <span class='k'>this</span><span class='p'>.</span><span class='nx'>editor</span><span class='p'>.</span><span class='nx'>update</span><span class='p'>({</span><span class='nx'>todo</span><span class='o'>:</span> <span class='nx'>todo</span><span class='p'>});</span>
    <span class='p'>},</span> <span class='k'>this</span><span class='p'>))</span>
  <span class='p'>},</span>
  <span class='s2'>&quot;.todo selected&quot;</span> <span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>el</span><span class='p'>,</span> <span class='nx'>ev</span><span class='p'>,</span> <span class='nx'>todo</span><span class='p'>){</span>
    <span class='nx'>$</span><span class='p'>.</span><span class='nx'>route</span><span class='p'>.</span><span class='nx'>attr</span><span class='p'>(</span><span class='s1'>&#39;id&#39;</span><span class='p'>,</span><span class='nx'>todo</span><span class='p'>.</span><span class='nx'>id</span><span class='p'>);</span>
  <span class='p'>}</span>
<span class='p'>});</span>

<span class='c1'>// create routing control</span>
<span class='k'>new</span> <span class='nx'>Routing</span><span class='p'>(</span><span class='nb'>document</span><span class='p'>.</span><span class='nx'>body</span><span class='p'>);</span>
</code></pre>
</div>
<p>The <strong>Routing</strong> control is a traditional controller. It coordinates between the <code>$.route</code>, <code>Editor</code> and <code>Todos</code>. <code>Editor</code> and <code>Todos</code> are traditional views, consuming models.</p>

<p>If you can understand this, you understand everything. Congrats! <a href='http://donejs.com/docs.html#!tutorials/rapidstart/todos.html'>See it in action</a>.</p>

<h2 id='utilities'>Utilities</h2>

<p>CanJS provides a number of utility methods. Most of the time, they are mapped to the underlying library. But, by using only these methods, you can create plugins that work with any library. Also, these methods are required to run CanJS from another library.</p>

<h3 id='string_helpers'>String Helpers</h3>
<div class='highlight'><pre><code class='javascript'><span class='c1'>// remove leading and trailing whitespace</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>trim</span><span class='p'>(</span> <span class='s2'>&quot; foo &quot;</span> <span class='p'>)</span> <span class='c1'>// -&gt; &quot;foo&quot; </span>
</code></pre>
</div>
<h3 id='array_helpers'>Array Helpers</h3>
<div class='highlight'><pre><code class='javascript'><span class='c1'>// convert array-like data into arrays</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>makeArray</span><span class='p'>({</span><span class='mi'>0</span> <span class='o'>:</span> <span class='s2'>&quot;zero&quot;</span><span class='p'>,</span> <span class='mi'>1</span><span class='o'>:</span> <span class='s2'>&quot;one&quot;</span><span class='p'>,</span> <span class='nx'>length</span><span class='o'>:</span> <span class='mi'>2</span><span class='p'>})</span> <span class='c1'>// -&gt; [&quot;zero&quot;,&quot;one&quot;]</span>
	
<span class='c1'>// return if an array is an array</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>isArray</span><span class='p'>([])</span> <span class='c1'>//-&gt; true</span>
	
<span class='c1'>// converts one array to another array</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>map</span><span class='p'>([{</span><span class='nx'>prop</span><span class='o'>:</span> <span class='s2'>&quot;val1&quot;</span><span class='p'>},</span> <span class='p'>{</span><span class='nx'>prop</span><span class='o'>:</span> <span class='s2'>&quot;val2&quot;</span><span class='p'>}],</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>val</span><span class='p'>,</span> <span class='nx'>prop</span><span class='p'>){</span>
  <span class='k'>return</span> <span class='nx'>val</span>
<span class='p'>})</span>  <span class='c1'>//-&gt; [&quot;val1&quot;,&quot;val2&quot;]</span>
	
<span class='c1'>// iterates through an array</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>each</span><span class='p'>([{</span><span class='nx'>prop</span><span class='o'>:</span> <span class='s2'>&quot;val1&quot;</span><span class='p'>},</span> <span class='p'>{</span><span class='nx'>prop</span><span class='o'>:</span> <span class='s2'>&quot;val2&quot;</span><span class='p'>}],</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>index</span><span class='p'>,</span> <span class='nx'>value</span> <span class='p'>)</span> <span class='p'>{</span>
  <span class='c1'>// function called with</span>
  <span class='c1'>//  index=0 value={prop: &quot;val1&quot;}</span>
  <span class='c1'>//  index=1 value={prop: &quot;val2&quot;}</span>
<span class='p'>})</span>
</code></pre>
</div>
<h3 id='object_helpers'>Object Helpers</h3>
<div class='highlight'><pre><code class='javascript'><span class='c1'>// extends one object with the properties of another</span>
<span class='kd'>var</span> <span class='nx'>first</span> <span class='o'>=</span> <span class='p'>{},</span>
    <span class='nx'>second</span> <span class='o'>=</span> <span class='p'>{</span><span class='nx'>a</span><span class='o'>:</span> <span class='s2'>&quot;b&quot;</span><span class='p'>},</span>
    <span class='nx'>thrid</span> <span class='o'>=</span> <span class='p'>{</span><span class='nx'>c</span><span class='o'>:</span> <span class='s2'>&quot;d&quot;</span><span class='p'>};</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>extend</span><span class='p'>(</span><span class='nx'>first</span><span class='p'>,</span> <span class='nx'>second</span><span class='p'>,</span> <span class='nx'>third</span><span class='p'>);</span> <span class='c1'>//-&gt; first</span>
<span class='nx'>first</span>  <span class='c1'>//-&gt; {a: &quot;b&quot;,c : &quot;d&quot;}</span>
<span class='nx'>second</span> <span class='c1'>//-&gt; {a: &quot;b&quot;}</span>
<span class='nx'>thrid</span>  <span class='c1'>//-&gt; {c: &quot;d&quot;}</span>
	
<span class='c1'>// deep extends one object with another</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>extend</span><span class='p'>(</span> <span class='kc'>true</span><span class='p'>,</span> <span class='nx'>first</span><span class='p'>,</span> <span class='nx'>second</span><span class='p'>,</span> <span class='nx'>third</span> <span class='p'>);</span> 
	
<span class='c1'>// parameterize into a querystring</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>param</span><span class='p'>({</span><span class='nx'>a</span><span class='o'>:</span> <span class='s2'>&quot;b&quot;</span><span class='p'>,</span> <span class='nx'>c</span><span class='o'>:</span> <span class='s2'>&quot;d&quot;</span><span class='p'>})</span> <span class='c1'>//-&gt; &quot;a=b&amp;c=d&quot;</span>
	
<span class='c1'>// returns if an object is empty</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>isEmptyObject</span><span class='p'>({})</span>      <span class='c1'>//-&gt; true</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>isEmptyObject</span><span class='p'>({</span><span class='nx'>a</span><span class='o'>:</span><span class='s2'>&quot;b&quot;</span><span class='p'>})</span> <span class='c1'>//-&gt; false</span>
</code></pre>
</div>
<h3 id='function_helpers'>Function Helpers</h3>
<div class='highlight'><pre><code class='javascript'><span class='c1'>// returns a function that calls another function</span>
<span class='c1'>// with &quot;this&quot; set.</span>
<span class='kd'>var</span> <span class='nx'>func</span> <span class='o'>=</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>proxy</span><span class='p'>(</span><span class='kd'>function</span><span class='p'>(</span><span class='nx'>one</span><span class='p'>){</span>
  <span class='k'>return</span> <span class='k'>this</span><span class='p'>.</span><span class='nx'>a</span> <span class='o'>+</span> <span class='nx'>one</span>
<span class='p'>},</span> <span class='p'>{</span><span class='nx'>a</span><span class='o'>:</span> <span class='s2'>&quot;b&quot;</span><span class='p'>});</span> 
<span class='nx'>func</span><span class='p'>(</span><span class='s2'>&quot;two&quot;</span><span class='p'>)</span> <span class='c1'>//-&gt; &quot;btwo&quot; </span>

<span class='c1'>// returns if an object is a function</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>isFunction</span><span class='p'>({})</span>           <span class='c1'>//-&gt; false</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>isFunction</span><span class='p'>(</span><span class='kd'>function</span><span class='p'>(){})</span> <span class='c1'>//-&gt; true</span>
</code></pre>
</div>
<h3 id='event_helpers'>Event Helpers</h3>
<div class='highlight'><pre><code class='javascript'><span class='c1'>// binds handler on obj&#39;s eventName event</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>bind</span><span class='p'>(</span><span class='nx'>obj</span><span class='p'>,</span> <span class='nx'>eventName</span><span class='p'>,</span> <span class='nx'>handler</span> <span class='p'>)</span>

<span class='c1'>// unbind handler on obj&#39;s eventName event</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>unbind</span><span class='p'>(</span><span class='nx'>obj</span><span class='p'>,</span> <span class='nx'>eventName</span><span class='p'>,</span> <span class='nx'>handler</span><span class='p'>)</span> 
	
<span class='c1'>// </span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>delegate</span><span class='p'>(</span><span class='nx'>obj</span><span class='p'>,</span> <span class='nx'>selector</span><span class='p'>,</span> <span class='nx'>eventName</span><span class='p'>,</span> <span class='nx'>handler</span><span class='p'>)</span>
	
<span class='c1'>//</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>delegate</span><span class='p'>(</span><span class='nx'>obj</span><span class='p'>,</span> <span class='nx'>selector</span><span class='p'>,</span> <span class='nx'>eventName</span><span class='p'>,</span> <span class='nx'>handler</span><span class='p'>)</span>
	
<span class='c1'>//</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>trigger</span><span class='p'>(</span><span class='nx'>obj</span><span class='p'>,</span> <span class='nx'>event</span><span class='p'>,</span> <span class='nx'>args</span> <span class='p'>)</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>trigger</span><span class='p'>(</span><span class='nx'>obj</span><span class='p'>,</span> <span class='nx'>eventName</span><span class='p'>,</span> <span class='nx'>args</span><span class='p'>)</span>
</code></pre>
</div>
<h3 id='deferred'>Deferred</h3>
<div class='highlight'><pre><code class='javascript'><span class='c1'>// Creates a new Deferred object</span>
<span class='kd'>var</span> <span class='nx'>deferred</span> <span class='o'>=</span> <span class='k'>new</span> <span class='nx'>can</span><span class='p'>.</span><span class='nx'>Deferred</span><span class='p'>()</span>

<span class='c1'>// pipes a deferred into another deferred</span>
<span class='nx'>deferred</span><span class='p'>.</span><span class='nx'>pipe</span><span class='p'>(</span><span class='kd'>function</span><span class='p'>(){</span>

<span class='p'>},</span> <span class='kd'>function</span><span class='p'>(){})</span>

<span class='c1'>// </span>
<span class='nx'>deferred</span><span class='p'>.</span><span class='nx'>resolve</span><span class='p'>()</span>
	
<span class='c1'>//</span>
<span class='nx'>deferred</span><span class='p'>.</span><span class='nx'>reject</span><span class='p'>()</span>
	
<span class='c1'>// </span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>When</span><span class='p'>()</span>
</code></pre>
</div>
<h3 id='ajax'>Ajax</h3>
<div class='highlight'><pre><code class='javascript'><span class='nx'>can</span><span class='p'>.</span><span class='nx'>ajax</span><span class='p'>({</span>
  <span class='nx'>url</span> <span class='o'>:</span> <span class='s2'>&quot;url&quot;</span><span class='p'>,</span>
  <span class='nx'>type</span><span class='o'>:</span> <span class='s2'>&quot;GET&quot;</span><span class='p'>,</span> <span class='c1'>// &quot;POST&quot;</span>
  <span class='nx'>async</span> <span class='o'>:</span> <span class='kc'>false</span><span class='p'>,</span>
  <span class='nx'>dataType</span><span class='o'>:</span> <span class='s2'>&quot;json&quot;</span><span class='p'>,</span>
  <span class='nx'>success</span><span class='o'>:</span> <span class='kd'>function</span><span class='p'>(){},</span>
  <span class='nx'>error</span><span class='o'>:</span> <span class='kd'>function</span><span class='p'>(){}</span>
<span class='p'>})</span> <span class='c1'>//-&gt; deferred</span>
</code></pre>
</div>
<h3 id='htmlelement_helpers'>HTMLElement Helpers</h3>
<div class='highlight'><pre><code class='javascript'><span class='nx'>can</span><span class='p'>.</span><span class='nx'>buildFragment</span><span class='p'>(</span><span class='nx'>frags</span><span class='p'>,</span> <span class='nx'>nodes</span><span class='p'>)</span>

<span class='c1'>// a node list</span>
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>$</span><span class='p'>(</span><span class='s2'>&quot;div.bar&quot;</span><span class='p'>)</span> <span class='c1'>//-&gt; []</span>

<span class='nx'>can</span><span class='p'>.</span><span class='nx'>append</span><span class='p'>(</span><span class='nx'>NodeList</span><span class='p'>,</span> <span class='nx'>html</span><span class='p'>)</span>
	
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>remove</span><span class='p'>(</span><span class='nx'>NodeList</span><span class='p'>)</span>
	
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>data</span><span class='p'>(</span><span class='nx'>NodeList</span><span class='p'>,</span> <span class='nx'>dataName</span><span class='p'>,</span> <span class='nx'>dataValue</span><span class='p'>)</span>
	
<span class='nx'>can</span><span class='p'>.</span><span class='nx'>addClass</span><span class='p'>(</span><span class='nx'>NodeList</span><span class='p'>,</span> <span class='nx'>className</span> <span class='p'>)</span>
</code></pre>
</div>
<p><strong>HTMLElement &#8216;destroyed&#8217; event</strong></p>

<p>When an element is removed from the page, a &#8216;destroyed&#8217; event should be triggered on the event. This is used to teardown event handlers in can.Control.</p>

<h2 id='use_with_other_libraries'>Use with other libraries</h2>

<p>CanJS can be used with libraries other than jQuery.</p>

<h3 id='implementing_another_library'>Implementing another library</h3>

<h2 id='plugins'>Plugins</h2>

<h3 id='construct_proxy'>construct proxy</h3>

<h3 id='construct_super'>construct super</h3>

<h3 id='control_plugin'>control plugin</h3>

<h3 id='control_view'>control view</h3>

<h3 id='observe_attributes'>observe attributes</h3>

<h3 id='observe_delegate'>observe delegate</h3>

<h3 id='observe_setter'>observe setter</h3>

<h3 id='model_backup'>model backup</h3>

<h3 id='model_validations'>model validations</h3>

<h3 id='model_elements'>model elements</h3>

<h3 id='view_modifiers'>view modifiers</h3>

<h2 id='examples'>Examples</h2>

<p>Examples of canJS.</p>
		</div>
	</div>
</div>
<script src="javascripts/jquery-1.7.1.min.js" type="text/javascript"></script>
<script src="javascripts/jquerymx-3.2.custom.js" type="text/javascript"></script>
<script src="javascripts/application.js" type="text/javascript"></script>
</body>
</html>